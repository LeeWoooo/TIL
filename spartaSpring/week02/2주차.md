2주차

RDBMS의 기초 지식을 습득

Spring Data JAP의 사용법

REST API를 만드는 방법을 익히기

H2는 RDBMS의 한 종류로 서버가 켜져있는 동안에만 작동하는 RDB이다.

JAP Repository

스프링은 자바로 작동하고 데이터베이스는 SQL로 작동한다 자바명령어를 SQL로 잘 번역하는 역할을 한다.(자바를 이용한 CRUD를 좀 더 쉽게?)
Repository는 클래스의 한 역할에 해당하는데 데이터에 접근하는데 사용하는 하나의 도구 JPA를 작동시키는 매게체

API Lombok DTO

API는 클라이언틍 서버간의 약속

DTO는 데이터를 주고받을 때 사용하는 것

lombok을 이용하여 코드를 절약

h2를 사용하기 위해 resources안에 application.properties안에
```java
spring.h2.console.enabled=true //스프링의 h2 db의 콘솔을 보이게 해줘
spring.datasource.url=jdbc:h2:mem:testdb//스프링의 데이터베이스를 h2를 쓸꺼야 라고 알려주는 것
```

를 추가해준다.

2일차

JPA : SQL을 쓰지않고 데이터를 생성 조회 수정 삭제 할 수 있도록 하는 번역기

프로젝트 시작할 떄 JPA를 선택하였지요 그걸로 바로 사용할 수 있다.

스프링에서 도메인(Entity) 테이블과 1:1 대응
Repository이 SQL역할을 한다 Repository이에 써있는 코드가 JPA를 사용한다.

JPA는 인터페이스로만 사용이 가능하다.

JpaRepository를 상속받아서 Repository를 구현한다.

JpaRepository 인터페이스는 org.springframework.data.jpa.repository 패키지의 "JpaRepository"라는 인터페이스를 상속하여 만든다. 이 인터페이스는 범용적으로 사용한다. 코드를 보면 이런 형태로 쓰여져 있는 것을 알 수 있을 것이다.

public interface 이름 extends JpaRepository <엔티티 ID 유형>


```java
package com.sparta.week2.domain;

import lombok.NoArgsConstructor;

import javax.persistence.*;


@NoArgsConstructor // 기본생성자를 대신 생성해줍니다.
@Entity // 테이블임을 나타냅니다. 데이터베이스 기준으로 table역할을 하는 class임을 선언
public class Course {

    @Id // ID 값, Primary Key로 사용하겠다는 뜻입니다. PK지정
    @GeneratedValue(strategy = GenerationType.AUTO) // 자동 증가 명령입니다.
    private Long id;

    @Column(nullable = false) // 컬럼 값이고 반드시 값이 존재해야 함을 나타냅니다.
    private String title;

    @Column(nullable = false) //DB에서 NOT NULL 제약조건과 동일
    private String tutor;

    //setter를 생성하지 않는 이유는 Repository에서 처리해준다.
    public String getTitle() {
        return this.title;
    }

    public String getTutor() {
        return this.tutor;
    }

    public Course(String title, String tutor) {
        this.title = title;
        this.tutor = tutor;
    }
}
```

```java
package com.sparta.week2.domain;

import org.springframework.data.jpa.repository.JpaRepository;

//<>안에는 테이블 명과 id의 자료형을 넣어준다.
public interface CourseRepository extends JpaRepository<Course, Long> {
    //CourseRepository sql의 역할을 대신해준다.
    //JpaRepository를 상속받아서 <Course, Long>을 할당해준다.
    //Course는 table명 id의 자료형이 Long이다.
}
```

사용
```java
 // Week02Application.java 의 main 함수 아래에 붙여주세요.
//튜터가 임시로 만든 코드 현제 JPA의 이용을 이해하기 위해
@Bean
public CommandLineRunner demo(CourseRepository repository) {
    return (args) -> {
        Course course1 = new Course("웹개발의 봄 Spring", "이우길"); //테이블은 생성 되었고 거기에 객체를 생성하여 값을 넣어준다.
        repository.save(course1); //insert

        List<Course> courseList = repository.findAll(); //select

        for(Course course : courseList){
            System.out.println(course);
            System.out.println(course.getTitle());
            System.out.println(course.getTutor());
        }
    };
}
```

## Service

DB를 꺼내오는 녀석과 응답하는 녀석의 연결고리. 

update는 밖에서 요청이 들어고 repository까지 전달을 해줘야한다. 이 때 중간에 있는 Service를 이용해야한다.

1. Entity class에 update method 생성
```java
//서비스
public void update(Course course) {
    this.title = course.title;
    this.tutor = course.tutor;
}
```

2. service라는 package를 만들고 Service class를 생성한다.
```java
@Service // 스프링에게 이 클래스는 서비스임을 명시 sql고 ㅏ같은 업데이트 하는 작용이 일어날 수도 있다고 스프링한테 이야기한다.
public class CourseService {

    // final: 서비스에게 꼭 필요한 녀석임을 명시
    //대상이 되는 Repository를 선언
    private final CourseRepository courseRepository;

    // 생성자를 통해, Service 클래스를 만들 때 꼭 Repository를 넣어주도록
    // 스프링에게 알려줌 
    // Service class가 생성될 때 매개변수로 들어오는 Repository를 넣어서 멤버변수에 할당
    public CourseService(CourseRepository courseRepository) {
        this.courseRepository = courseRepository;
    }

    @Transactional // SQL 쿼리가 일어나야 함을 스프링에게 알려줌
    public Long update(Long id, Course course) { //반환값이 Long인 이유는 어떠한 것이 update됬는지 id값 반환
        Course course1 = courseRepository.findById(id).orElseThrow(
                () -> new IllegalArgumentException("해당 아이디가 존재하지 않습니다.")
        );
        course1.update(course);
        return course1.getId();
    }
}
```


## LomBok

LomBok은 자바 프로젝트를 진행하는데 거의 필수적으로 필요하다. 자동 생성해줌으로 써 코드를 절약할 수 있도록 도와주는 라이브러리이다.

<br>

## DTO (Data Transfer Object)

데이터를 전달하는 객체

## API

클라이언트가 정한대로 서버에게 요청을 하면 서버가 요구사항을 처리하는 응답을 반환한다. CRUD에 따라 API를 나눈다.

## REST 규칙

REST란 주소에 명사,요청방식에 동사를 사용함으로써 의도를 명확히 드러냄을 의마한다.

여기서 쓰이는 동사는 CRUD를 지칭한다.

생성(POST) 조회(GET) 수정 (PUT) 삭제(DELETE)


## 주의사항

주소에 들어가는 명사들은 복수형을 사용한다 ex)/course
주소에 동사는 가급적으로 사용하지 않는다.  

## GET

데이터를 조회하는 API를 만들어보자.

## POST

생성 요청 

POST는 요청하는 방식이 정해져있다. 어떤 데이터를 만들지 건내줘야하기 때문.
POST방식에서 데이터를 전달하는 방식은 엄격하게!!! 정해져있다. 이해보다 암기에 가깝다!

Content-Type application/json

## PUT 

수정

## DELETE

삭제
